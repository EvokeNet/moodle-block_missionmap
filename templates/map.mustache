{{! @template block_mission_map/map }}
<div class="map">
    {{#chapters}}
    <!-- Chapter is locked -->
    {{#isLocked}}
    <div id="chapter_{{id}}" class="chapter grid">
        <div class="locked"></div>
        <div class="chapter_header">
            <h3>{{name}}</h3>
            <h3 class="lock_info">{{#str}} chapter_locked, block_mission_map {{/str}}</h3>
            <h3 data-countdown="{{unlocking_date}}">{{#str}} chapter_countdown, block_mission_map {{/str}}</h3>
        </div>
        <img src="{{img}}" /> {{#levels}}
        <a href="#" class="mission" data-toggle="tooltip" data-placement="top" title="{{description}}" data-html="true">
            <span class="mission-text">
                            {{name}}
                        </span>
        </a>
        {{/levels}}
    </div>
    {{/isLocked}}

    <!-- Chapter is unlocked -->
    {{^isLocked}}
    <div class="chapter grid">
        <div class="chapter_header">
            <h3>{{name}}</h3>
        </div>
        <img src="{{img}}" /> {{#levels}} {{#isCompleted}}
        <a href="{{url}}" class="mission full {{color}}" data-toggle="tooltip" data-placement="top" title="{{description}}" data-html="true">
            <span class="mission-text">
                                {{name}}
                            </span>
        </a>
        {{/isCompleted}} {{^isCompleted}}
        <a href="{{url}}" class="mission outlined {{color}}" data-toggle="tooltip" data-placement="top" title="{{description}}" data-html="true">
            <span class="mission-text">
                                {{name}}
                            </span>
        </a>
        {{/isCompleted}} {{/levels}}
        {{#can_add_mission}}
        <button type="button" class="btn btn-sm btn-success add-mission-btn" data-chapter-id="{{id}}" data-chapter-name="{{name}}" style="position: absolute; top: 10px; right: 10px; z-index: 10;">
            <i class="fa fa-plus"></i> Add Mission
        </button>
        {{/can_add_mission}}
    </div>
    {{/isLocked}} {{/chapters}}
</div>
{{#js}} require(['block_mission_map/randomizer'], function(module) { module.init(); } ); require(['block_mission_map/countdown'], function(module) { module.init(); } ); {{/js}}