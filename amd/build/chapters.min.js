define ("block_mission_map/chapters",["exports","core/modal_factory","core/modal_events","core/fragment","core/ajax","core/notification","core/templates"],function(a,b,c,d,e,f,g){"use strict";Object.defineProperty(a,"__esModule",{value:!0});a.init=void 0;b=h(b);c=h(c);d=h(d);e=h(e);f=h(f);g=h(g);function h(a){return a&&a.__esModule?a:{default:a}}var i=function(a){var d=a.contextid,e=a.blockid,f=a.courseid;b.default.create({type:b.default.types.SAVE_CANCEL,title:"Add Chapter",body:j(null,d)}).then(function(a){var b=document.getElementById("add_chapter");document.addEventListener("click",function(b){if(b.target&&b.target.classList.contains("edit_chapter")){k(b,a,e,f,!0)}});var g=a.getRoot(),h=g.find("form");b.addEventListener("click",function(b){return k(b,a,e,f)});g.on(c.default.save,function(a){return l(a,h)});h.on("submit",function(b){return m(b,a,h,d)})}).then(function(a){a.close()})};a.init=i;var j=function(a,b){if("undefined"==typeof a){a={}}var c={jsonformdata:JSON.stringify(a)};return d.default.loadFragment("block_mission_map","chapter_form",b,c)},k=function(a,b,c,d){var e=4<arguments.length&&arguments[4]!==void 0?arguments[4]:!1;a.preventDefault();b.show();var f=b.getRoot();f.find("form").find("input[name=\"blockid\"]").val(c);f.find("form").find("input[name=\"courseid\"]").val(d);if(e){f.find("form").find("input[name=\"id\"]").val(a.target.dataset.cid);f.find("form").find("input[name=\"name\"]").val(a.target.dataset.cname);f.find("form").find("select[name=\"islocked\"]").val(a.target.dataset.haslock);f.find("form").find("input[name=\"unlocking_date\"]").val(a.target.dataset.unlock)}},l=function(a,b){a.preventDefault();b.submit()},m=function(a,b,c,d){a.preventDefault();var f=c.serialize();e.default.call([{methodname:"block_mission_map_create_chapter",args:{contextid:d,jsonformdata:JSON.stringify(f)},done:function done(a){return o(a,b)},fail:function fail(a){return n(a)}}])},n=function(a){f.default.alert("Warning",JSON.parse(a),"Continue")},o=function(a,b){var c=document.getElementById("mission_map"),d=JSON.parse(a.data);if(!0==d.updated){location.reload()}else{var e={id:d.id,name:d.name};g.default.render("block_mission_map/chapter",e).then(function(a,d){g.default.appendNodeContents(c,a,d);b.hide()}).fail(function(a){f.default.alert("Warning",a,"Continue")})}}});
//# sourceMappingURL=chapters.min.js.map
