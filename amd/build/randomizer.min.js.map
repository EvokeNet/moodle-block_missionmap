{"version":3,"file":"randomizer.min.js","sources":["../src/randomizer.js"],"sourcesContent":["export const init = () => {\n    const screen_size = window.screen.width;\n    const map_image = document.querySelector('img');\n\n    if (screen_size <= 600) {\n        return;\n    }\n\n    if (map_image.complete) {\n        randomize();\n        initTooltips();\n    } else {\n        map_image.addEventListener('load', () => {\n            randomize();\n            initTooltips();\n        });\n        map_image.addEventListener('error', () => {\n            window.console.log('Error while randomizing missions on the map');\n        });\n    }\n};\n\nconst initTooltips = () => {\n    // Initialize tooltips for mission descriptions\n    const missionElements = document.querySelectorAll('.mission[data-toggle=\"tooltip\"]');\n    \n    missionElements.forEach(element => {\n        // Check if tooltip is already initialized\n        if (!element.hasAttribute('data-tooltip-initialized')) {\n            // Mark as initialized\n            element.setAttribute('data-tooltip-initialized', 'true');\n            \n            // Try different tooltip approaches\n            if (typeof bootstrap !== 'undefined' && bootstrap.Tooltip) {\n                // Bootstrap 5\n                try {\n                    const tooltip = new bootstrap.Tooltip(element, {\n                        placement: 'top',\n                        trigger: 'hover',\n                        delay: { show: 300, hide: 100 },\n                        html: true,\n                        sanitize: false\n                    });\n                    console.log('Bootstrap 5 tooltip initialized');\n                } catch (e) {\n                    console.log('Bootstrap 5 tooltip failed:', e);\n                    initCustomTooltip(element);\n                }\n            } else if (typeof $ !== 'undefined' && $.fn.tooltip) {\n                // Bootstrap 4 or jQuery tooltip\n                try {\n                    $(element).tooltip({\n                        placement: 'top',\n                        trigger: 'hover',\n                        delay: { show: 300, hide: 100 },\n                        html: true\n                    });\n                    console.log('jQuery tooltip initialized');\n                } catch (e) {\n                    console.log('jQuery tooltip failed:', e);\n                    initCustomTooltip(element);\n                }\n            } else {\n                // Use custom tooltip implementation\n                initCustomTooltip(element);\n            }\n        }\n    });\n    \n    console.log('Tooltip initialization completed for', missionElements.length, 'elements');\n};\n\nconst initCustomTooltip = (element) => {\n    const title = element.getAttribute('title');\n    if (!title) return;\n    \n    // Remove the title attribute to prevent native tooltip\n    element.removeAttribute('title');\n    \n    // Create tooltip element\n    const tooltip = document.createElement('div');\n    tooltip.className = 'mission-tooltip';\n    tooltip.innerHTML = title;\n    tooltip.style.cssText = `\n        position: absolute;\n        background: #333;\n        color: white;\n        padding: 8px 12px;\n        border-radius: 4px;\n        font-size: 12px;\n        z-index: 1000;\n        pointer-events: none;\n        opacity: 0;\n        transition: opacity 0.3s ease;\n        max-width: 200px;\n        word-wrap: break-word;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.3);\n    `;\n    \n    document.body.appendChild(tooltip);\n    \n    let showTimeout, hideTimeout;\n    \n    element.addEventListener('mouseenter', () => {\n        clearTimeout(hideTimeout);\n        showTimeout = setTimeout(() => {\n            const rect = element.getBoundingClientRect();\n            \n            // Make tooltip visible first to get dimensions\n            tooltip.style.opacity = '1';\n            tooltip.style.visibility = 'hidden'; // Hidden but taking up space\n            \n            // Position tooltip directly above the mission dot\n            const centerX = rect.left + (rect.width / 2);\n            const tooltipX = centerX - (tooltip.offsetWidth / 2);\n            const tooltipY = rect.top - tooltip.offsetHeight - 2; // Very close gap - just 2px\n            \n            tooltip.style.left = tooltipX + 'px';\n            tooltip.style.top = tooltipY + 'px';\n            \n            // Now make it visible\n            tooltip.style.visibility = 'visible';\n            \n            console.log('Tooltip positioned at:', tooltip.style.left, tooltip.style.top);\n            console.log('Mission dot at:', rect.left, rect.top);\n            console.log('Mission center X:', centerX);\n            console.log('Tooltip width:', tooltip.offsetWidth);\n            console.log('Tooltip height:', tooltip.offsetHeight);\n            console.log('Gap between tooltip and mission:', rect.top - tooltipY - tooltip.offsetHeight);\n        }, 300);\n    });\n    \n    element.addEventListener('mouseleave', () => {\n        clearTimeout(showTimeout);\n        hideTimeout = setTimeout(() => {\n            tooltip.style.opacity = '0';\n        }, 100);\n    });\n    \n    console.log('Custom tooltip initialized for:', title);\n};\n\nconst randomize = () => {\n    const chapters = document.querySelectorAll('.chapter');\n\n    const seed = xmur3('avocadotoast');\n    const rand = sfc32(seed(), seed(), seed(), seed());\n\n    for (let i = 0; i < chapters.length; i++) {\n        let chapter_width = chapters[i].offsetWidth;\n        let chapter_height = chapters[i].offsetHeight;\n        let missions = chapters[i].querySelectorAll('.mission');\n\n        let division = chapter_width / missions.length;\n\n        let perc_division = division / chapter_width;\n        let offsetLeft = 0.05;\n\n        for (let j = 0; j < missions.length; j++) {\n            let mission_height = missions[j].offsetHeight;\n            let height_discount = mission_height / chapter_height;\n\n            let posx = offsetLeft * 100;\n            var posy = (rand() * (1 - height_discount) * 100).toFixed();\n\n            missions[j].style.left = `${posx}%`;\n            missions[j].style.top = `${posy}%`;\n            missions[j].style.transform = `translate(-${posx}%, -${posy}%)`;\n            offsetLeft += perc_division;\n        }\n    }\n};\n\n/* eslint-disable */\nconst xmur3 = (str) => {\n    for (var i = 0, h = 1779033703 ^ str.length; i < str.length; i++)\n        (h = Math.imul(h ^ str.charCodeAt(i), 3432918353)),\n            (h = (h << 13) | (h >>> 19));\n    return function () {\n        h = Math.imul(h ^ (h >>> 16), 2246822507);\n        h = Math.imul(h ^ (h >>> 13), 3266489909);\n        return (h ^= h >>> 16) >>> 0;\n    };\n};\n\nconst sfc32 = (a, b, c, d) => {\n    return function () {\n        a >>>= 0;\n        b >>>= 0;\n        c >>>= 0;\n        d >>>= 0;\n        var t = (a + b) | 0;\n        a = b ^ (b >>> 9);\n        b = (c + (c << 3)) | 0;\n        c = (c << 21) | (c >>> 11);\n        d = (d + 1) | 0;\n        t = (t + d) | 0;\n        c = (c + t) | 0;\n        return (t >>> 0) / 4294967296;\n    };\n};\n"],"names":["screen_size","window","screen","width","map_image","document","querySelector","complete","randomize","initTooltips","addEventListener","console","log","missionElements","querySelectorAll","forEach","element","hasAttribute","setAttribute","bootstrap","Tooltip","placement","trigger","delay","show","hide","html","sanitize","e","initCustomTooltip","$","fn","tooltip","length","title","getAttribute","removeAttribute","createElement","showTimeout","hideTimeout","className","innerHTML","style","cssText","body","appendChild","clearTimeout","setTimeout","rect","getBoundingClientRect","opacity","visibility","centerX","left","tooltipX","offsetWidth","tooltipY","top","offsetHeight","chapters","seed","xmur3","rand","sfc32","i","chapter_width","chapter_height","missions","perc_division","offsetLeft","j","height_discount","posx","posy","toFixed","transform","str","h","Math","imul","charCodeAt","a","b","c","d","t"],"mappings":"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"}