{"version":3,"file":"randomizer.min.js","sources":["../src/randomizer.js"],"sourcesContent":["export const init = () => {\n    const screen_size = window.screen.width;\n    const map_image = document.querySelector('img');\n\n    if (screen_size <= 600) {\n        return;\n    }\n\n    if (map_image.complete) {\n        randomize();\n        initTooltips();\n    } else {\n        map_image.addEventListener('load', () => {\n            randomize();\n            initTooltips();\n        });\n        map_image.addEventListener('error', () => {\n            window.console.log('Error while randomizing missions on the map');\n        });\n    }\n};\n\nconst initTooltips = () => {\n    // Initialize tooltips for mission descriptions\n    const missionElements = document.querySelectorAll('.mission[data-toggle=\"tooltip\"]');\n    \n    missionElements.forEach(element => {\n        // Check if tooltip is already initialized\n        if (!element.hasAttribute('data-tooltip-initialized')) {\n            // Mark as initialized\n            element.setAttribute('data-tooltip-initialized', 'true');\n            \n            // Always use custom tooltip implementation for better control\n            initCustomTooltip(element);\n        }\n    });\n    \n    console.log('Tooltip initialization completed for', missionElements.length, 'elements');\n};\n\nconst initCustomTooltip = (element) => {\n    const title = element.getAttribute('title');\n    if (!title) return;\n    \n    // Remove the title attribute to prevent native tooltip\n    element.removeAttribute('title');\n    \n    // Create tooltip element\n    const tooltip = document.createElement('div');\n    tooltip.className = 'mission-tooltip';\n    tooltip.innerHTML = title;\n    tooltip.style.cssText = `\n        position: fixed;\n        background: rgba(0, 0, 0, 0.9);\n        color: white;\n        padding: 8px 12px;\n        border-radius: 4px;\n        font-size: 12px;\n        z-index: 10000;\n        pointer-events: none;\n        opacity: 0;\n        visibility: hidden;\n        transition: opacity 0.3s ease;\n        max-width: 200px;\n        word-wrap: break-word;\n        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);\n    `;\n    \n    document.body.appendChild(tooltip);\n    \n    let showTimeout, hideTimeout;\n    \n    element.addEventListener('mouseenter', () => {\n        clearTimeout(hideTimeout);\n        showTimeout = setTimeout(() => {\n            const rect = element.getBoundingClientRect();\n            \n            // Make tooltip visible first to get dimensions\n            tooltip.style.opacity = '1';\n            tooltip.style.visibility = 'hidden'; // Hidden but taking up space\n            \n            // Position tooltip directly above the mission dot\n            const centerX = rect.left + (rect.width / 2);\n            const tooltipX = centerX - (tooltip.offsetWidth / 2);\n            const tooltipY = rect.top - tooltip.offsetHeight - 2; // Very close gap - just 2px\n            \n            tooltip.style.left = tooltipX + 'px';\n            tooltip.style.top = tooltipY + 'px';\n            \n            // Now make it visible\n            tooltip.style.visibility = 'visible';\n            \n            console.log('Tooltip positioned at:', tooltip.style.left, tooltip.style.top);\n            console.log('Mission dot at:', rect.left, rect.top);\n            console.log('Mission center X:', centerX);\n            console.log('Tooltip width:', tooltip.offsetWidth);\n            console.log('Tooltip height:', tooltip.offsetHeight);\n            console.log('Gap between tooltip and mission:', rect.top - tooltipY - tooltip.offsetHeight);\n        }, 300);\n    });\n    \n    element.addEventListener('mouseleave', () => {\n        clearTimeout(showTimeout);\n        hideTimeout = setTimeout(() => {\n            tooltip.style.opacity = '0';\n            setTimeout(() => {\n                tooltip.style.visibility = 'hidden';\n            }, 300);\n        }, 100);\n    });\n    \n    // Function to update tooltip position\n    const updateTooltipPosition = () => {\n        if (tooltip.style.visibility === 'visible') {\n            const rect = element.getBoundingClientRect();\n            const centerX = rect.left + (rect.width / 2);\n            const tooltipX = centerX - (tooltip.offsetWidth / 2);\n            const tooltipY = rect.top - tooltip.offsetHeight - 5;\n            \n            tooltip.style.left = tooltipX + 'px';\n            tooltip.style.top = tooltipY + 'px';\n        }\n    };\n    \n    // Update position on scroll and resize\n    window.addEventListener('scroll', updateTooltipPosition, { passive: true });\n    window.addEventListener('resize', updateTooltipPosition, { passive: true });\n    \n    console.log('Custom scroll-aware tooltip initialized for:', title);\n};\n\nconst randomize = () => {\n    const chapters = document.querySelectorAll('.chapter');\n\n    const seed = xmur3('avocadotoast');\n    const rand = sfc32(seed(), seed(), seed(), seed());\n\n    for (let i = 0; i < chapters.length; i++) {\n        let chapter_width = chapters[i].offsetWidth;\n        let chapter_height = chapters[i].offsetHeight;\n        let missions = chapters[i].querySelectorAll('.mission');\n\n        let division = chapter_width / missions.length;\n\n        let perc_division = division / chapter_width;\n        let offsetLeft = 0.05;\n\n        for (let j = 0; j < missions.length; j++) {\n            let mission_height = missions[j].offsetHeight;\n            let height_discount = mission_height / chapter_height;\n\n            let posx = offsetLeft * 100;\n            var posy = (rand() * (1 - height_discount) * 100).toFixed();\n\n            // Position the mission element\n            missions[j].style.left = `${posx}%`;\n            missions[j].style.top = `${posy}%`;\n            missions[j].style.transform = `translate(-${posx}%, -${posy}%)`;\n            \n            // Also position the mission container if it exists\n            const missionContainer = missions[j].closest('.mission-container');\n            if (missionContainer) {\n                missionContainer.style.position = 'absolute';\n                missionContainer.style.left = `${posx}%`;\n                missionContainer.style.top = `${posy}%`;\n                missionContainer.style.transform = `translate(-${posx}%, -${posy}%)`;\n            }\n            \n            offsetLeft += perc_division;\n        }\n    }\n};\n\n/* eslint-disable */\nconst xmur3 = (str) => {\n    for (var i = 0, h = 1779033703 ^ str.length; i < str.length; i++)\n        (h = Math.imul(h ^ str.charCodeAt(i), 3432918353)),\n            (h = (h << 13) | (h >>> 19));\n    return function () {\n        h = Math.imul(h ^ (h >>> 16), 2246822507);\n        h = Math.imul(h ^ (h >>> 13), 3266489909);\n        return (h ^= h >>> 16) >>> 0;\n    };\n};\n\nconst sfc32 = (a, b, c, d) => {\n    return function () {\n        a >>>= 0;\n        b >>>= 0;\n        c >>>= 0;\n        d >>>= 0;\n        var t = (a + b) | 0;\n        a = b ^ (b >>> 9);\n        b = (c + (c << 3)) | 0;\n        c = (c << 21) | (c >>> 11);\n        d = (d + 1) | 0;\n        t = (t + d) | 0;\n        c = (c + t) | 0;\n        return (t >>> 0) / 4294967296;\n    };\n};\n"],"names":["screen_size","window","screen","width","map_image","document","querySelector","complete","randomize","initTooltips","addEventListener","console","log","missionElements","querySelectorAll","forEach","element","hasAttribute","setAttribute","initCustomTooltip","length","title","getAttribute","removeAttribute","tooltip","createElement","showTimeout","hideTimeout","className","innerHTML","style","cssText","body","appendChild","clearTimeout","setTimeout","rect","getBoundingClientRect","opacity","visibility","centerX","left","tooltipX","offsetWidth","tooltipY","top","offsetHeight","updateTooltipPosition","passive","chapters","seed","xmur3","rand","sfc32","i","chapter_width","chapter_height","missions","perc_division","offsetLeft","j","height_discount","posx","posy","toFixed","transform","missionContainer","closest","position","str","h","Math","imul","charCodeAt","a","b","c","d","t"],"mappings":"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"}